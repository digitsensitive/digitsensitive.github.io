<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="initial-scale=1,width=device-width"><link crossorigin=anonymous href=https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css integrity=sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor rel=stylesheet><script crossorigin=anonymous integrity=sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2 src=https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.css><link href=/favicon.ico rel=icon><link rel=stylesheet href=/css/syntax.css><link rel=stylesheet href=/css/styles.css><title>digitsensitive</title></head><body class="p-3 bg-dark"><nav class="navbar navbar-dark navbar-expand-lg"><div class=container-fluid><a class=navbar-brand href=/>Hello</a>
<button aria-controls=navbar aria-expanded=false aria-label="Toggle navigation" class=navbar-toggler data-bs-target=#navbar data-bs-toggle=collapse type=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbar><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/about/ title>About</a></li><li class=nav-item><a class=nav-link href=/notes/ title>Notes</a></li><li class=nav-item><a class=nav-link href=/posts/ title>Posts</a></li></ul></div></div></nav><div class="container text-light py-4 mx-auto" style=max-width:650px><h1>Print String in Commodore 64 Assembly Language</h1><h6>December 27, 2022</h6><div class="row mt-4 my-4"><p><img src=./header-image.png alt="Print String in Commodore 64 Assembly Language" title="Print String in Commodore 64 Assembly Language"></p><p>When the THEC64 from Retro Games was released at the end of December 2019, I was
able to spend some time making up for lost time with the so-called &ldquo;breadbox&rdquo;.</p><p>With a lot of interest I read through the official Commodore 64 User&rsquo;s Guide and
learnd some BASIC, the onboard programming language. In the last two years I
have been playing with the C64 on and off and have also been looking into the
6502 assembly programming language.</p><p>In this short article I&rsquo;m going to show you one way to print a string in 6502
assembly programming language.</p><h2 id=output-in-vice>Output in VICE</h2><p>Here you can see the final result. We simply print the string <strong>COMMODORE 64</strong>
at the top left corner of the screen.</p><p><img src=./vice1.png alt="VICE Print String" title="VICE Print String"></p><p>In BASIC this can be done with this simple line of code (although the position
will be different):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl><span class=kr>PRINT</span><span class=w> </span><span class=s2>&#34;COMMODORE 64&#34;</span>
</span></span></code></pre></div><h2 id=source-code>Source Code</h2><p>You can access the source code on my github repository
<a href=https://raw.githubusercontent.com/digitsensitive/c64/main/src/c64-users-guide/print.asm>here</a>.</p><h2 id=notes>Notes</h2><p>Loading the string with the upper code takes <strong>470 cycles</strong> (see below how to
calculate number of cycles used). I tried different other options, which in
general use less space, but take significant more cycles. For example this
approach, using the subroutines <code>$e50c</code> and <code>$ab1e</code> will take <strong>5192 cycles</strong>
and does exactly the same.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl><span class=w>        </span><span class=vg>ldx</span><span class=w> </span><span class=err>#$</span><span class=il>00</span><span class=w>                </span><span class=p>;</span><span class=w> </span><span class=vg>Select</span><span class=w> </span><span class=vg>row</span>
</span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>ldy</span><span class=w> </span><span class=err>#$</span><span class=il>00</span><span class=w>                </span><span class=p>;</span><span class=w> </span><span class=vg>Select</span><span class=w> </span><span class=vg>column</span>
</span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>jsr</span><span class=w> </span><span class=err>$</span><span class=vg>e50c</span><span class=w>               </span><span class=p>;</span><span class=w> </span><span class=vg>Set</span><span class=w> </span><span class=vg>cursor</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=vg>print</span><span class=w>   </span><span class=vg>lda</span><span class=w> </span><span class=err>#</span><span class=o>&lt;</span><span class=vg>str</span><span class=w>               </span><span class=p>;</span><span class=w> </span><span class=vg>Load</span><span class=w> </span><span class=vg>lo</span><span class=o>-</span><span class=vg>byte</span><span class=w> </span><span class=vg>of</span><span class=w> </span><span class=vg>string</span><span class=w> </span><span class=vg>adress</span>
</span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>ldy</span><span class=w> </span><span class=err>#</span><span class=o>&gt;</span><span class=vg>str</span><span class=w>               </span><span class=p>;</span><span class=w> </span><span class=vg>Load</span><span class=w> </span><span class=vg>hi</span><span class=o>-</span><span class=vg>byte</span><span class=w> </span><span class=vg>of</span><span class=w> </span><span class=vg>string</span><span class=w> </span><span class=vg>adress</span>
</span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>jsr</span><span class=w> </span><span class=err>$</span><span class=vg>ab1e</span><span class=w>               </span><span class=p>;</span><span class=w> </span><span class=vg>Print</span><span class=w> </span><span class=vg>string</span>
</span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>rts</span><span class=w>                     </span><span class=p>;</span><span class=w> </span><span class=vg>End</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=vg>str</span><span class=w>     </span><span class=o>.</span><span class=vg>text</span><span class=w> </span><span class=s2>&#34;COMMODORE 64&#34;</span>
</span></span><span class=line><span class=cl><span class=w>        </span><span class=o>.</span><span class=vg>byte</span><span class=w> </span><span class=err>$</span><span class=il>00</span>
</span></span></code></pre></div><h2 id=how-to-detect-number-of-cycles-used-in-vice>How to detect number of cycles used in VICE</h2><ol><li>Activate monitor: File -> Activate monitor</li><li>Disassemble instructions from the start of the program: d $02a7</li><li>Set two breakpoints: break $02a7 and break $02b9</li><li>Close monitor</li><li>Run program: SYS 679</li><li>Write down STOPWATCH number</li><li>Close monitor</li><li>Write down STOPWATCH number</li><li>Calculate cycles used: Difference of both STOPWATCH numbers</li></ol><p>For more informations about the VICE monitor, have a look at the
<a href=https://vice-emu.sourceforge.io/vice_12.html>official manual</a>.</p><h2 id=references>References</h2><ul><li><a href=https://www.commodore.ca/manuals/c64_users_guide/c64-users_guide.htm>Commodore 64 User&rsquo;s Guide</a></li><li><a href=https://retrogames.biz/products/thec64>Retro Games THEC64</a></li><li><a href=https://vice-emu.sourceforge.io>VICE - the Versatile Commodore Emulator</a></li></ul></div><span class="p-2 my-1 mx-auto badge text-bg-dark">6502</span>
<span class="p-2 my-1 mx-auto badge text-bg-dark">Assembly</span>
<span class="p-2 my-1 mx-auto badge text-bg-dark">C64</span>
<span class="p-2 my-1 mx-auto badge text-bg-dark">Commodore 64</span>
<span class="p-2 my-1 mx-auto badge text-bg-dark">Retro</span></div><footer class="text-light mb-5 small text-center">Copyright &#169; 2024 digitsensitive</footer></body></html>